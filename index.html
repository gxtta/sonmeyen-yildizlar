<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÃ¶nmeyen YÄ±ldÄ±zlar - Dijital AnÄ±t</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { margin: 0; overflow: hidden; background-color: #050000; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 3px; }
        
        #tooltip { pointer-events: none; transform: translate(-50%, -150%); z-index: 40; }
        
        #loading-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #050000; z-index: 50; display: flex;
            justify-content: center; align-items: center; flex-direction: column;
            transition: opacity 1s ease;
        }

        /* Detay Paneli Stilleri */
        .detail-row { display: flex; justify-content: space-between; align-items: flex-start; padding: 10px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .detail-label { color: #9ca3af; font-size: 0.85rem; display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
        .detail-value { color: #f3f4f6; font-weight: 500; font-size: 0.9rem; text-align: right; word-break: break-word; }

        #search-results::-webkit-scrollbar { width: 4px; }
        #search-results::-webkit-scrollbar-thumb { background: #db2777; border-radius: 4px; }

        /* SeÃ§im Modu Ä°mleci */
        body.selection-active canvas { cursor: crosshair !important; }
        
        /* Buton Animasyonu */
        .pulse-ring {
            box-shadow: 0 0 0 0 rgba(219, 39, 119, 0.7);
            animation: pulse-red 2s infinite;
        }
        @keyframes pulse-red {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(219, 39, 119, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(219, 39, 119, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(219, 39, 119, 0); }
        }

        /* Modal GeÃ§iÅŸleri */
        .modal-content { transform: scale(0.95); opacity: 0; transition: all 0.3s ease-out; }
        .modal-open .modal-content { transform: scale(1); opacity: 1; }
    </style>
</head>
<body class="antialiased text-gray-100">

    <canvas id="webgl" class="absolute top-0 left-0 w-full h-full z-0 pointer-events-auto"></canvas>

    <!-- YÃ¼kleme EkranÄ± -->
    <div id="loading-overlay">
        <div class="w-16 h-16 border-4 border-red-900 border-t-pink-500 rounded-full animate-spin mb-4"></div>
        <p class="text-pink-300 text-sm tracking-widest animate-pulse">VERÄ°LER YÃœKLENÄ°YOR...</p>
    </div>

    <!-- ================= MODALLAR (POP-UP PENCERELER) ================= -->

    <!-- 1. BAÅLANGIÃ‡ BÄ°LGÄ°LENDÄ°RME -->
    <div id="intro-modal" class="absolute inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm transition-opacity duration-500">
        <div class="bg-[#1a0505] border border-red-900/50 rounded-2xl p-8 max-w-md text-center shadow-[0_0_50px_rgba(220,20,60,0.2)] mx-4 relative">
            <div class="w-16 h-16 bg-gradient-to-br from-pink-600 to-red-900 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
                <i class="fa-solid fa-hand-pointer text-2xl text-white"></i>
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">HoÅŸ Geldiniz</h2>
            <p class="text-gray-300 text-sm mb-6 leading-relaxed">
                SÃ¶nmeyen YÄ±ldÄ±zlar anÄ±tÄ±nda her bir Ä±ÅŸÄ±k bir yaÅŸamÄ± temsil eder.<br><br>
                <span class="text-pink-400 font-semibold">ğŸ–±ï¸ Gezinmek iÃ§in:</span> EkranÄ± sÃ¼rÃ¼kleyin.<br>
                <span class="text-pink-400 font-semibold">âœ¨ Detay gÃ¶rmek iÃ§in:</span> Sol alttaki <br> <span class="border border-white/20 px-1 rounded bg-white/10"><i class="fa-solid fa-arrow-pointer text-xs"></i> SeÃ§im Modu</span> butonunu aÃ§Ä±p yÄ±ldÄ±zlara tÄ±klayÄ±n.
            </p>
            <button id="close-intro-btn" class="px-8 py-3 bg-gradient-to-r from-red-900 to-pink-700 hover:from-red-800 hover:to-pink-600 text-white rounded-full font-medium transition-all transform hover:scale-105 shadow-lg">
                AnladÄ±m, BaÅŸla
            </button>
        </div>
    </div>

    <!-- 2. GÃœVENLÄ°K REHBERÄ° (YENÄ° KALKAN BUTONU Ä°Ã‡Ä°N) -->
    <div id="defense-modal" class="hidden absolute inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
        <div class="modal-content bg-[#100505] border border-pink-900/30 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl relative">
            <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-white text-2xl">&times;</button>
            
            <div class="p-8">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3 border-b border-white/10 pb-4">
                    <i class="fa-solid fa-shield-halved text-pink-500"></i> KadÄ±nlar Ä°Ã§in GÃ¼venlik Rehberi
                </h2>

                <div class="grid gap-6 md:grid-cols-2">
                    <!-- KADES -->
                    <div class="bg-white/5 p-5 rounded-lg border border-white/5 hover:border-pink-500/30 transition-colors">
                        <h3 class="text-pink-300 font-bold text-lg mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-mobile-screen-button"></i> KADES UygulamasÄ±
                        </h3>
                        <p class="text-gray-300 text-sm leading-relaxed">
                            Emniyet Genel MÃ¼dÃ¼rlÃ¼ÄŸÃ¼'nÃ¼n resmi uygulamasÄ±dÄ±r. Acil durumlarda tek tuÅŸla konumunuzu paylaÅŸarak en yakÄ±n polis ekibinin gelmesini saÄŸlar.
                        </p>
                        <a href="https://play.google.com/store/apps/details?id=tr.gov.egm.kades" target="_blank" class="inline-block mt-3 text-xs text-blue-400 hover:text-blue-300 underline">Ä°ndirmek iÃ§in tÄ±klayÄ±n</a>
                    </div>

                    <!-- ACÄ°L NUMARALAR -->
                    <div class="bg-white/5 p-5 rounded-lg border border-white/5 hover:border-pink-500/30 transition-colors">
                        <h3 class="text-pink-300 font-bold text-lg mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-phone-volume"></i> Acil Numaralar
                        </h3>
                        <ul class="text-gray-300 text-sm space-y-2">
                            <li><span class="font-bold text-white">112</span> - Acil Ã‡aÄŸrÄ± Merkezi (Polis/Ambulans)</li>
                            <li><span class="font-bold text-white">183</span> - Sosyal Destek HattÄ± (7/24)</li>
                            <li><span class="font-bold text-white">155</span> - Polis Ä°mdat</li>
                            <li><span class="font-bold text-white">156</span> - Jandarma Ä°mdat</li>
                        </ul>
                    </div>

                    <!-- 6284 -->
                    <div class="bg-white/5 p-5 rounded-lg border border-white/5 hover:border-pink-500/30 transition-colors md:col-span-2">
                        <h3 class="text-pink-300 font-bold text-lg mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-gavel"></i> 6284 SayÄ±lÄ± Kanun & HaklarÄ±nÄ±z
                        </h3>
                        <p class="text-gray-300 text-sm leading-relaxed mb-2">
                            Åiddete uÄŸrayan veya uÄŸrama tehlikesi bulunan kadÄ±nlar, Ã§ocuklar ve aile bireyleri bu kanunla korunur.
                        </p>
                        <ul class="list-disc list-inside text-gray-400 text-sm space-y-1">
                            <li>Delil veya belge aranmaksÄ±zÄ±n koruma kararÄ± talep edebilirsiniz.</li>
                            <li>Åiddet uygulayanÄ±n evden uzaklaÅŸtÄ±rÄ±lmasÄ±nÄ± isteyebilirsiniz.</li>
                            <li>Barolardan Ã¼cretsiz avukat (Adli YardÄ±m) talep edebilirsiniz.</li>
                            <li>ÅÃ–NÄ°M (Åiddet Ã–nleme ve Ä°zleme Merkezleri) size rehberlik eder.</li>
                        </ul>
                    </div>

                    <!-- KÄ°ÅÄ°SEL GÃœVENLÄ°K Ä°PUÃ‡LARI -->
                    <div class="bg-gradient-to-br from-white/5 to-pink-900/10 p-5 rounded-lg border border-pink-500/20 hover:border-pink-500/40 transition-colors md:col-span-2">
                        <h3 class="text-pink-300 font-bold text-lg mb-2 flex items-center gap-2">
                            <i class="fa-solid fa-person-rays"></i> KiÅŸisel GÃ¼venlik ve Savunma Ä°puÃ§larÄ±
                        </h3>
                        <ul class="text-gray-300 text-sm space-y-2 list-disc list-inside marker:text-pink-500">
                            <li><strong class="text-white">Konum PaylaÅŸÄ±mÄ±:</strong> Taksiye bindiÄŸinizde veya gÃ¼vensiz hissettiÄŸinizde, gÃ¼vendiÄŸiniz birine canlÄ± konumunuzu atÄ±n ve bunu telefonla konuÅŸarak belli edin.</li>
                            <li><strong class="text-white">Ã‡evresel FarkÄ±ndalÄ±k:</strong> YÃ¼rÃ¼rken telefona odaklanmak yerine Ã§evrenizi gÃ¶zlemleyin. Takip edildiÄŸinizi hissederseniz kalabalÄ±k bir yere veya aÃ§Ä±k bir dÃ¼kkana girin.</li>
                            <li><strong class="text-white">Anahtarlar:</strong> Eve yaklaÅŸÄ±rken anahtarlarÄ±nÄ±zÄ± elinizde hazÄ±r tutun. Bu hem hÄ±zlÄ± girmenizi saÄŸlar hem de acil durumda savunma aracÄ± olabilir.</li>
                            <li><strong class="text-white">Ses Ã‡Ä±karÄ±n:</strong> Tehlike anÄ±nda "Ä°mdat" veya "YangÄ±n" diye baÄŸÄ±rmak saldÄ±rganÄ± ÅŸaÅŸÄ±rtabilir.</li>
                            <li><strong class="text-white">AsansÃ¶r GÃ¼venliÄŸi:</strong> AsansÃ¶re binerken ÅŸÃ¼pheli biriyle yalnÄ±z kalmamaya Ã§alÄ±ÅŸÄ±n, kapÄ±ya yakÄ±n durun.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. HAKKINDA (INFO) - YENÄ° Ä°Ã‡ERÄ°K -->
    <div id="info-modal" class="hidden absolute inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
        <div class="modal-content bg-[#100505] border border-blue-900/30 rounded-xl w-full max-w-md shadow-2xl relative text-center">
            <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-white text-2xl">&times;</button>
            
            <div class="p-8">
                <div class="w-16 h-16 bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fa-solid fa-laptop-code text-3xl text-blue-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white mb-2">HakkÄ±nda</h2>
                <p class="text-gray-400 text-sm mb-6 leading-relaxed">
                    Bu proje, kadÄ±n cinayetlerine dikkat Ã§ekmek ve hayatÄ±nÄ± kaybeden kadÄ±nlarÄ±n anÄ±sÄ±nÄ± dijital bir evrende sonsuza kadar yaÅŸatmak amacÄ±yla oluÅŸturulmuÅŸtur.
                </p>

                <div class="bg-white/5 p-4 rounded-lg border border-white/10 mb-4 text-left">
                    <h3 class="text-white font-bold text-sm mb-2 flex items-center gap-2">
                        <i class="fa-solid fa-wand-magic-sparkles text-yellow-400"></i> Teknoloji
                    </h3>
                    <p class="text-gray-400 text-xs">
                        Bu websitesi, tasarÄ±mÄ±ndan kodlamasÄ±na kadar tamamen <strong>Google Gemini Yapay Zeka</strong> modeli ile geliÅŸtirilmiÅŸtir. Veriler anlÄ±k olarak gÃ¼ncellenmektedir.
                    </p>
                </div>

                <div class="text-xs text-gray-500 mt-4">
                    <p>Veri KaynaÄŸÄ±: AnÄ±t SayaÃ§</p>
                    <p>TasarÄ±m & Kodlama: Gemini AI</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 4. BAÄIÅ & DESTEK (DONATE) -->
    <div id="donate-modal" class="hidden absolute inset-0 z-[60] flex items-center justify-center bg-black/90 backdrop-blur-md p-4">
        <div class="modal-content bg-[#100505] border border-pink-900/30 rounded-xl w-full max-w-md shadow-2xl relative">
            <button class="close-modal-btn absolute top-4 right-4 text-gray-400 hover:text-white text-2xl">&times;</button>
            
            <div class="p-8 text-center">
                <div class="w-16 h-16 bg-pink-900/30 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fa-solid fa-hand-holding-heart text-3xl text-pink-400"></i>
                </div>
                <h2 class="text-xl font-bold text-white mb-2">DayanÄ±ÅŸma YaÅŸatÄ±r</h2>
                <p class="text-gray-400 text-xs mb-6">KadÄ±n mÃ¼cadelesini gÃ¼Ã§lendirmek iÃ§in resmi kurumlara ve derneklere destek olabilirsiniz.</p>

                <div class="space-y-3 text-left">
                    <!-- Mor Ã‡atÄ± -->
                    <a href="https://morcati.org.tr/bagis-yap/" target="_blank" class="flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg group transition-all">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded bg-purple-600 flex items-center justify-center text-white font-bold">M</div>
                            <div>
                                <h4 class="text-white text-sm font-bold group-hover:text-pink-300">Mor Ã‡atÄ± VakfÄ±</h4>
                                <p class="text-[10px] text-gray-500">KadÄ±n sÄ±ÄŸÄ±naÄŸÄ± ve dayanÄ±ÅŸma merkezi.</p>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-white"></i>
                    </a>

                    <!-- KCDP -->
                    <a href="https://kadincinayetlerinidurduracagiz.net/" target="_blank" class="flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg group transition-all">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded bg-red-600 flex items-center justify-center text-white font-bold"><i class="fa-solid fa-hand-fist"></i></div>
                            <div>
                                <h4 class="text-white text-sm font-bold group-hover:text-pink-300">KadÄ±n Cinayetlerini D.P.</h4>
                                <p class="text-[10px] text-gray-500">Hukuki mÃ¼cadele ve eylem platformu.</p>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-white"></i>
                    </a>

                    <!-- TKDF -->
                    <a href="https://tkdf.org.tr/" target="_blank" class="flex items-center justify-between p-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg group transition-all">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded bg-blue-600 flex items-center justify-center text-white font-bold">F</div>
                            <div>
                                <h4 class="text-white text-sm font-bold group-hover:text-pink-300">TKDF</h4>
                                <p class="text-[10px] text-gray-500">TÃ¼rkiye KadÄ±n Dernekleri Federasyonu.</p>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-white"></i>
                    </a>

                    <hr class="border-white/10 my-4">

                    <!-- Patreon -->
                    <a href="#" class="flex items-center justify-center gap-2 p-3 bg-gradient-to-r from-orange-600 to-red-600 text-white text-sm font-bold rounded-lg hover:opacity-90 transition-opacity opacity-50 cursor-not-allowed" title="YakÄ±nda eklenecek">
                        <i class="fa-solid fa-coffee"></i> GeliÅŸtiriciye Kahve Ismarla (YakÄ±nda)
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= ANA ARAYÃœZ ================= -->

    <div class="relative z-10 pointer-events-none w-full h-screen">
        
        <!-- Sol Ãœst BaÅŸlÄ±k -->
        <div class="absolute top-0 left-0 p-8 pointer-events-auto z-10">
            <h1 class="text-4xl font-light tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-pink-300 to-red-600 drop-shadow-lg">
                SÃ–NMEYEN YILDIZLAR
            </h1>
            <p class="mt-2 text-sm text-red-100 opacity-70 max-w-md font-light">
                Her bir yÄ±ldÄ±z, aramÄ±zdan koparÄ±lan bir Ä±ÅŸÄ±ÄŸÄ± temsil eder.<br>
                <span id="total-count" class="font-bold text-white">...</span> can sonsuzluÄŸa karÄ±ÅŸtÄ±.
            </p>
        </div>

        <!-- SAÄ ÃœST: Arama ve Butonlar -->
        <div class="absolute top-6 right-6 z-30 pointer-events-auto flex gap-3 items-center flex-row-reverse">
            <!-- Arama -->
            <div class="relative group w-48 md:w-64">
                <input type="text" id="search-input" 
                    class="w-full bg-black/40 border border-white/20 rounded-full py-2.5 pl-5 pr-10 text-sm text-white focus:outline-none focus:border-pink-500/50 focus:bg-black/80 transition-all placeholder-gray-500 backdrop-blur-sm shadow-lg"
                    placeholder="Ä°sim ara...">
                <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 group-hover:text-pink-400 transition-colors">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
                <!-- SonuÃ§lar -->
                <div id="search-results" class="hidden mt-2 bg-[#0a0505]/95 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl max-h-60 overflow-y-auto absolute w-full z-40"></div>
            </div>

            <!-- Bilgi Butonu (HakkÄ±nda) -->
            <button id="open-info-btn" class="w-8 h-8 rounded-full bg-white/10 border border-white/20 text-gray-300 hover:bg-white/20 hover:text-white hover:border-blue-500/50 transition-all flex items-center justify-center backdrop-blur-sm" title="HakkÄ±nda">
                <i class="fa-solid fa-info text-sm"></i>
            </button>

            <!-- YENÄ° GÃœVENLÄ°K REHBERÄ° BUTONU (KALKAN) -->
            <button id="open-defense-btn" class="w-8 h-8 rounded-full bg-white/10 border border-white/20 text-gray-300 hover:bg-white/20 hover:text-pink-300 hover:border-pink-500/50 transition-all flex items-center justify-center backdrop-blur-sm" title="GÃ¼venlik Rehberi">
                <i class="fa-solid fa-shield-halved text-sm"></i>
            </button>
        </div>

        <!-- SOL ALT: SeÃ§im Modu ve BAÄIÅ Butonu -->
        <div class="absolute bottom-8 left-8 z-30 pointer-events-auto flex flex-col gap-4 items-start">
            
            <!-- BaÄŸÄ±ÅŸ Butonu -->
            <button id="open-donate-btn" class="w-12 h-12 rounded-full bg-gradient-to-tr from-red-900 to-pink-800 border border-white/10 text-white flex items-center justify-center shadow-lg hover:scale-110 transition-transform group" title="Destek Ol">
                <i class="fa-solid fa-heart text-lg group-hover:animate-pulse"></i>
            </button>

            <!-- SeÃ§im Modu -->
            <div class="flex flex-col items-start">
                <div id="mode-tooltip" class="bg-black/80 text-white text-xs px-2 py-1 rounded mb-1 opacity-0 transition-opacity">SeÃ§im Modu: KapalÄ±</div>
                <button id="toggle-selection-mode" class="w-14 h-14 rounded-full bg-black/60 border-2 border-gray-500 text-gray-400 flex items-center justify-center transition-all hover:scale-110 hover:bg-black/80 shadow-2xl backdrop-blur-md">
                    <i class="fa-solid fa-arrow-pointer text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Kaynak Linki (SaÄŸ Alt) -->
        <a href="https://anitsayac.com/" target="_blank" class="absolute bottom-6 right-6 z-20 pointer-events-auto flex items-center gap-2 px-4 py-2 bg-black/40 border border-white/10 rounded-full text-xs text-gray-500 hover:text-pink-300 transition-all backdrop-blur-sm hover:bg-black/60">
            <span class="opacity-50">Veri KaynaÄŸÄ±:</span><span class="font-semibold">AnÄ±t SayaÃ§</span>
        </a>

        <!-- Tooltip -->
        <div id="tooltip" class="absolute hidden bg-black/90 border border-red-500/30 backdrop-blur px-4 py-2 rounded-lg shadow-[0_0_20px_rgba(255,0,0,0.3)] transition-opacity duration-200">
            <span id="tooltip-name" class="font-bold text-pink-200 text-lg block">Ä°sim</span>
            <span id="tooltip-date" class="text-xs text-gray-400 block text-center mt-1">Tarih</span>
        </div>

        <!-- Detay Paneli -->
        <div id="detail-panel" class="absolute top-0 right-0 h-full w-full md:w-[450px] bg-[#0a0505]/95 backdrop-blur-xl border-l border-red-900/30 shadow-2xl pointer-events-auto transform transition-transform duration-500 translate-x-full flex flex-col z-40">
            <button id="close-btn" class="absolute top-4 right-4 text-white/50 hover:text-white text-2xl z-20">&times;</button>
            <div class="p-8 flex-1 overflow-y-auto relative">
                <div class="flex flex-col items-center mt-4 mb-6">
                    <div class="w-20 h-20 rounded-full bg-gradient-to-b from-pink-600 to-red-900 p-[2px] shadow-[0_0_30px_rgba(220,20,60,0.4)]"><div class="w-full h-full bg-black rounded-full flex items-center justify-center"><i class="fa-solid fa-dove text-2xl text-white/90"></i></div></div>
                    <h2 id="panel-name" class="mt-4 text-2xl font-bold text-center text-white">...</h2>
                    <p id="panel-date-head" class="text-sm text-pink-400 uppercase tracking-wider font-medium">...</p>
                </div>
                <div class="bg-white/5 rounded-xl p-5 border border-white/5 mb-6">
                    <div class="detail-row"><span class="detail-label">Ä°l / Ä°lÃ§e</span><span id="det-location" class="detail-value">...</span></div>
                    <div class="detail-row"><span class="detail-label">YaÅŸ</span><span id="det-age" class="detail-value">...</span></div>
                    <div class="detail-row"><span class="detail-label">Fail</span><span id="det-killer" class="detail-value text-red-300">...</span></div>
                    <div class="detail-row"><span class="detail-label">Neden</span><span id="det-reason" class="detail-value">...</span></div>
                    <div class="detail-row"><span class="detail-label">Åekil</span><span id="det-method" class="detail-value">...</span></div>
                    <div class="detail-row"><span class="detail-label">Koruma</span><span id="det-protection" class="detail-value">...</span></div>
                    <div class="detail-row border-none"><span class="detail-label">Durum</span><span id="det-status" class="detail-value">...</span></div>
                </div>
                <a id="source-link" href="#" target="_blank" class="flex items-center justify-center gap-2 w-full py-3 mb-6 bg-gray-800/50 hover:bg-gray-800 text-gray-400 text-xs rounded transition-colors border border-white/10"><i class="fa-solid fa-external-link-alt"></i> Haberi GÃ¶rÃ¼ntÃ¼le</a>
                <hr class="border-white/10 mb-6">
                <div>
                    <h3 class="text-lg font-medium text-pink-300 mb-2 flex items-center gap-2"><i class="fa-solid fa-pen-nib"></i> AnÄ± Defteri</h3>
                    <textarea id="memory-input" rows="4" class="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-sm text-white focus:outline-none focus:border-pink-500/50 transition-colors resize-none placeholder-gray-600" placeholder="Bir not bÄ±rakÄ±n..."></textarea>
                    <div class="flex justify-end mt-3"><button id="save-btn" class="px-5 py-2 bg-gradient-to-r from-red-900 to-pink-800 hover:from-red-800 hover:to-pink-700 text-white text-xs font-bold rounded shadow-lg transition-all active:scale-95">KAYDET</button></div>
                    <p id="save-msg" class="text-xs text-green-400 mt-2 text-right hidden">Kaydedildi.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let namesList = [];
        let points = null; 
        let geometry = null;
        let isSelectionMode = false; 

        // --- MODAL YÃ–NETÄ°MÄ° ---
        const introModal = document.getElementById('intro-modal');
        const infoModal = document.getElementById('info-modal');
        const donateModal = document.getElementById('donate-modal');
        const defenseModal = document.getElementById('defense-modal'); // YENÄ°

        // Modal AÃ§ma/Kapatma
        function openModal(modal) {
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.add('modal-open'), 10);
        }
        function closeModal(modal) {
            modal.classList.remove('modal-open');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        document.getElementById('close-intro-btn').onclick = () => { introModal.style.opacity = '0'; setTimeout(() => introModal.style.display = 'none', 500); };
        document.getElementById('open-info-btn').onclick = () => openModal(infoModal);
        document.getElementById('open-donate-btn').onclick = () => openModal(donateModal);
        document.getElementById('open-defense-btn').onclick = () => openModal(defenseModal); // YENÄ°

        document.querySelectorAll('.close-modal-btn').forEach(btn => {
            btn.onclick = (e) => closeModal(e.target.closest('.absolute'));
        });

        window.addEventListener('click', (e) => {
            if (e.target === infoModal) closeModal(infoModal);
            if (e.target === donateModal) closeModal(donateModal);
            if (e.target === defenseModal) closeModal(defenseModal);
        });


        // --- SeÃ§im Modu ---
        const modeBtn = document.getElementById('toggle-selection-mode');
        const modeTooltip = document.getElementById('mode-tooltip');

        modeBtn.onclick = () => {
            isSelectionMode = !isSelectionMode;
            if(isSelectionMode) {
                modeBtn.classList.remove('border-gray-500', 'text-gray-400', 'bg-black/60');
                modeBtn.classList.add('border-pink-500', 'text-white', 'bg-pink-900/50', 'pulse-ring');
                document.body.classList.add('selection-active');
                modeTooltip.innerText = "SeÃ§im Modu: AÃ‡IK";
                modeTooltip.style.opacity = '1';
            } else {
                modeBtn.classList.add('border-gray-500', 'text-gray-400', 'bg-black/60');
                modeBtn.classList.remove('border-pink-500', 'text-white', 'bg-pink-900/50', 'pulse-ring');
                document.body.classList.remove('selection-active');
                modeTooltip.innerText = "SeÃ§im Modu: KAPALI";
                modeTooltip.style.opacity = '0';
            }
        };

        // --- Arama Kutusu ---
        const searchInput = document.getElementById('search-input');
        const searchResults = document.getElementById('search-results');
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLocaleLowerCase('tr');
            searchResults.innerHTML = ''; 
            if(query.length < 2) { searchResults.classList.add('hidden'); return; }
            const matches = namesList.map((p, i) => ({...p, originalIndex: i})).filter(p => p.name.toLocaleLowerCase('tr').includes(query)).slice(0, 10);
            if(matches.length > 0) {
                searchResults.classList.remove('hidden');
                matches.forEach(match => {
                    const div = document.createElement('div');
                    div.className = 'px-4 py-3 hover:bg-white/5 cursor-pointer border-b border-white/5 text-gray-200 text-sm';
                    div.innerText = match.name;
                    div.onclick = () => { 
                        openPanel(match.originalIndex); 
                        flyToStar(match.originalIndex); 
                        searchResults.classList.add('hidden'); 
                        searchInput.value = ''; 
                    };
                    searchResults.appendChild(div);
                });
            } else {
                searchResults.classList.remove('hidden'); searchResults.innerHTML = '<div class="px-4 py-3 text-xs text-gray-500 italic text-center">SonuÃ§ yok</div>';
            }
        });
        document.addEventListener('click', (e) => { if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) searchResults.classList.add('hidden'); });

        async function fetchNames() {
            try {
                const response = await fetch('anit_verileri.json?t=' + new Date().getTime());
                if (!response.ok) throw new Error('Veri yok');
                namesList = await response.json();
                document.getElementById('total-count').innerText = namesList.length.toLocaleString();
                generateGalaxy();
                document.getElementById('loading-overlay').style.display = 'none';
            } catch (error) {
                namesList = [{name: "Ã–zgecan Aslan", date: "11.02.2015"}, {name: "Emine Bulut", date: "18.08.2019"}];
                for(let i=0; i<500; i++) namesList.push({name: "Bilinmiyor", date: "..."});
                generateGalaxy();
                document.getElementById('loading-overlay').style.display = 'none';
            }
        }

        const canvas = document.getElementById('webgl');
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2('#050000', 0.03);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 4, 8);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; controls.autoRotate = true; controls.autoRotateSpeed = 0.5;

        function createHeartTexture() {
            const c = document.createElement('canvas'); c.width=32; c.height=32; const x = c.getContext('2d');
            x.fillStyle='#fff'; x.beginPath(); x.moveTo(16,28); x.bezierCurveTo(16,26,4,18,4,12);
            x.bezierCurveTo(4,6,10,4,16,10); x.bezierCurveTo(22,4,28,6,28,12); x.bezierCurveTo(28,18,16,26,16,28);
            x.fill(); x.shadowBlur=4; x.shadowColor="white"; x.fill(); return new THREE.CanvasTexture(c);
        }

        const generateGalaxy = () => {
            if(namesList.length === 0) return;
            const count = namesList.length;
            geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(count * 3);
            const colors = new Float32Array(count * 3);
            const nameIndices = new Float32Array(count);
            const colorIn = new THREE.Color('#ffc0cb');
            const colorOut = new THREE.Color('#8a0000');

            for(let i=0; i<count; i++) {
                const i3 = i*3;
                const r = Math.pow(i/count, 0.7) * 12; 
                const s = r * 1.2; 
                const b = (i % 4) / 4 * Math.PI * 2; 
                const rx = Math.pow(Math.random(), 3) * (Math.random()<0.5?1:-1) * 0.5 * r;
                const ry = Math.pow(Math.random(), 3) * (Math.random()<0.5?1:-1) * 0.5 * r;
                const rz = Math.pow(Math.random(), 3) * (Math.random()<0.5?1:-1) * 0.5 * r;

                positions[i3] = Math.cos(b+s)*r + rx;
                positions[i3+1] = ry/2;
                positions[i3+2] = Math.sin(b+s)*r + rz;

                const mixedColor = colorIn.clone(); mixedColor.lerp(colorOut, r/12);
                colors[i3] = mixedColor.r; colors[i3+1] = mixedColor.g; colors[i3+2] = mixedColor.b;
                nameIndices[i] = i;
            }
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            geometry.setAttribute('nameIndex', new THREE.BufferAttribute(nameIndices, 1));
            const material = new THREE.PointsMaterial({ size: 0.25, sizeAttenuation: true, depthWrite: false, blending: THREE.AdditiveBlending, vertexColors: true, map: createHeartTexture(), transparent: true, opacity: 0.8 });
            points = new THREE.Points(geometry, material);
            scene.add(points);
        }

        // --- MIKNATIS MANTIÄI ---
        function getNearestStarOnScreen(clientX, clientY) {
            if (!geometry || !points) return null;
            
            const positions = geometry.attributes.position.array;
            const count = namesList.length;
            let minDistance = 40; // Piksel
            let nearestIndex = -1;
            
            const tempVec = new THREE.Vector3();

            for(let i=0; i<count; i++) {
                tempVec.set(positions[i*3], positions[i*3+1], positions[i*3+2]);
                tempVec.project(camera);
                if(tempVec.z > 1) continue;

                const x = (tempVec.x * .5 + .5) * window.innerWidth;
                const y = (-(tempVec.y * .5) + .5) * window.innerHeight;
                const dist = Math.sqrt(Math.pow(x - clientX, 2) + Math.pow(y - clientY, 2));

                if(dist < minDistance) {
                    minDistance = dist;
                    nearestIndex = i;
                }
            }
            return nearestIndex;
        }

        // --- Mouse Move & Hover ---
        const tooltip = document.getElementById('tooltip');
        const tooltipName = document.getElementById('tooltip-name');
        const tooltipDate = document.getElementById('tooltip-date');

        window.addEventListener('mousemove', (e) => {
            const nearestIdx = getNearestStarOnScreen(e.clientX, e.clientY);

            if (nearestIdx !== -1 && nearestIdx !== null) {
                document.body.style.cursor = 'pointer';
                const nameIdx = geometry.attributes.nameIndex.array[nearestIdx];
                const person = namesList[nameIdx];
                tooltipName.innerText = person.name;
                tooltipDate.innerText = person.date || "";
                tooltip.style.left = (e.clientX + 15) + 'px';
                tooltip.style.top = (e.clientY + 15) + 'px';
                tooltip.classList.remove('hidden');
            } else {
                document.body.style.cursor = isSelectionMode ? 'crosshair' : 'default';
                tooltip.classList.add('hidden');
            }
        });

        // --- TÄ±klama MantÄ±ÄŸÄ± ---
        let clickStartX = 0;
        let clickStartY = 0;

        window.addEventListener('mousedown', (e) => {
            clickStartX = e.clientX;
            clickStartY = e.clientY;
        });

        window.addEventListener('mouseup', (e) => {
            if(e.button !== 0) return;
            const diffX = Math.abs(e.clientX - clickStartX);
            const diffY = Math.abs(e.clientY - clickStartY);

            if (diffX < 3 && diffY < 3) {
                if (!isSelectionMode) return; 
                if (e.target.closest('#detail-panel') || e.target.closest('#search-input') || e.target.closest('#search-results') || e.target.closest('a') || e.target.closest('.absolute')) return;

                const nearestIdx = getNearestStarOnScreen(e.clientX, e.clientY);
                if (nearestIdx !== -1 && nearestIdx !== null) {
                    openPanel(nearestIdx);
                    flyToStar(nearestIdx);
                }
            }
        });

        const els = { name: document.getElementById('panel-name'), dateHead: document.getElementById('panel-date-head'), location: document.getElementById('det-location'), age: document.getElementById('det-age'), killer: document.getElementById('det-killer'), reason: document.getElementById('det-reason'), method: document.getElementById('det-method'), protection: document.getElementById('det-protection'), status: document.getElementById('det-status'), sourceLink: document.getElementById('source-link'), input: document.getElementById('memory-input'), saveMsg: document.getElementById('save-msg') };
        let currentSelectedName = null;

        function openPanel(index) {
            controls.autoRotate = false;
            const person = namesList[index];
            currentSelectedName = person.name;
            const safe = (val) => (val && val.length > 1) ? val : "Bilinmiyor";
            els.name.innerText = person.name;
            els.dateHead.innerText = safe(person.date);
            els.location.innerText = safe(person.location);
            els.age.innerText = safe(person.age);
            els.killer.innerText = safe(person.killer);
            els.reason.innerText = safe(person.reason);
            els.method.innerText = safe(person.method);
            els.protection.innerText = safe(person.protection);
            els.status.innerText = safe(person.status);
            if(person.source && person.source.startsWith('http')) { els.sourceLink.href = person.source; els.sourceLink.style.display = 'flex'; } else { els.sourceLink.style.display = 'none'; }
            els.input.value = localStorage.getItem(`note_${person.name}`) || "";
            els.saveMsg.classList.add('hidden');
            document.getElementById('detail-panel').classList.remove('translate-x-full');
        }

        function flyToStar(index) {
            if (!geometry) return;
            const positions = geometry.attributes.position.array;
            const targetPos = new THREE.Vector3(positions[index*3], positions[index*3+1], positions[index*3+2]);
            const offset = new THREE.Vector3(0, 0.5, 2); 
            const camPos = targetPos.clone().add(offset);
            new TWEEN.Tween(camera.position).to({x:camPos.x, y:camPos.y, z:camPos.z}, 2000).easing(TWEEN.Easing.Cubic.Out).start();
            new TWEEN.Tween(controls.target).to({x:targetPos.x, y:targetPos.y, z:targetPos.z}, 2000).easing(TWEEN.Easing.Cubic.Out).start();
        }

        document.getElementById('close-btn').onclick = () => { document.getElementById('detail-panel').classList.add('translate-x-full'); controls.autoRotate = true; };
        document.getElementById('save-btn').onclick = () => { if(currentSelectedName) { localStorage.setItem(`note_${currentSelectedName}`, els.input.value); els.saveMsg.classList.remove('hidden'); setTimeout(() => els.saveMsg.classList.add('hidden'), 2000); } };
        window.addEventListener('resize', () => { camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); });

        function tick() {
            TWEEN.update();
            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(tick);
        }

        fetchNames();
        tick();
    </script>
</body>
</html>
